import { FloatingCartButton } from '../../../components/FloatingCartButton';

// ÂïÜÂìÅÊï∞ÊçÆÂÆö‰πâ
export interface product {
  image: string
  productName: string
  unit: string //Âçï‰Ωç
  price: number //‰ª∑Èí±
}

// ÂïÜÂÆ∂Êï∞ÊçÆÂÆö‰πâ
export interface merchant {
  image: string
  merchantName: string
  introduction: string
  positiveFeedbackRate: number
}

// ÈùôÊÄÅÂïÜÂìÅÊï∞ÊçÆ
export const productList: product[] = [
  {
    image: 'https://picsum.photos/200/200?random=7',
    productName: 'Êñ∞È≤úÁôΩËèú',
    unit: 'Êñ§',
    price: 1.5,
  },
  {
    image: 'https://images.unsplash.com/photo-1518977676601-b53f82aba655?w=200&h=200&fit=crop',
    productName: 'Êñ∞È≤úËÉ°ËêùÂçú',
    unit: 'Êñ§',
    price: 2.5
  },
  {
    image: 'https://images.unsplash.com/photo-1556801712-76c8eb07bbc9?w=200&h=200&fit=crop',
    productName: 'Êñ∞È≤úÂúüË±Ü',
    unit: 'Êñ§',
    price: 3.0
  },
  {
    image: 'https://images.unsplash.com/photo-1540420773420-3366772f4999?w=200&h=200&fit=crop',
    productName: 'Êñ∞È≤úË•øÁ∫¢Êüø',
    unit: 'Êñ§',
    price: 4.0
  },
  {
    image: 'https://images.unsplash.com/photo-1449300079323-02e209d9d3a6?w=200&h=200&fit=crop',
    productName: 'Êñ∞È≤úÈªÑÁìú',
    unit: '‰∏™',
    price: 3.5
  },
  {
    image: 'https://images.unsplash.com/photo-1525609004556-c46c7d6cf023?w=200&h=200&fit=crop',
    productName: 'Êñ∞È≤úËåÑÂ≠ê',
    unit: 'Êñ§',
    price: 2.8
  }
]

// ÈùôÊÄÅÂïÜÂÆ∂Êï∞ÊçÆ
export const merchantList: merchant[] = [
  {
    image: 'https://picsum.photos/200/160?random=1',
    merchantName: 'ËÄÅÁéãËî¨ËèúÂ∫ó',
    introduction: 'Êñ∞È≤úËî¨ËèúÔºåÊØèÊó•Áõ¥‰æõÔºå‰ª∑Ê†ºÂÆûÊÉ†',
    positiveFeedbackRate: 98
  }, {
  image: 'https://images.unsplash.com/photo-1506484381205-f7945653044d?w=200&h=160&fit=crop',
  merchantName: 'ËÄÅÊùéÊûúÂõ≠',
  introduction: '‰∫ßÂú∞Áõ¥ÈááÔºåÊ∞¥ÊûúÊñ∞È≤úÔºåÁîúÂ∫¶È´ò',
  positiveFeedbackRate: 97
},
  {
    image: 'https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=200&h=160&fit=crop',
    merchantName: 'ÈòøÂß®ÁÉòÁÑôÂ±ã',
    introduction: 'ÊâãÂ∑•Áé∞ÁÉ§Ôºå‰ΩéÁ≥ñÂÅ•Â∫∑ÔºåÂΩìÊó•ÈÖçÈÄÅ',
    positiveFeedbackRate: 99
  },
  {
    image: 'https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?w=200&h=160&fit=crop',
    merchantName: 'Ê∏îÂ§´Êµ∑È≤úÈì∫',
    introduction: 'ÂáåÊô®Á†ÅÂ§¥Áõ¥ÂèëÔºåÈ≤úÊ¥ªÂà∞ÂÆ∂ÔºåÂÜ∞Ë¢ã‰øùÈ≤ú',
    positiveFeedbackRate: 96
  },
  {
    image: 'https://images.unsplash.com/photo-1587049352846-4a222e784c38?w=200&h=160&fit=crop',
    merchantName: 'ÁâßÂú∫È≤úÂ•∂Á´ô',
    introduction: 'ÂΩìÊó•ÁâßÂú∫ÂÜ∑ËêÉÔºåÊó†Ê∑ªÂä†ÔºåÁéªÁíÉÁì∂ÂèØÈÄÄ',
    positiveFeedbackRate: 98
  },
  {
    image: 'https://images.unsplash.com/photo-1606923829579-0cb981a83e2e?w=200&h=160&fit=crop',
    merchantName: 'Â±±ÈáéËèåËèáÂùä',
    introduction: 'Ê∑±Â±±ÈááÊëòÔºåËá™ÁÑ∂ÊôæÊôíÔºåÊó†Á°´ÁÜè',
    positiveFeedbackRate: 97
  }
]


@Component
export struct MarketPage {
  @State selectedCategory: string = 'ÂÖ®ÈÉ®'
  readonly TABBAR_HEIGHT: number = 220
  @State products: product[] = productList
  @State merchants: merchant[] = merchantList
  @StorageProp('globalPageStack') pageStack: NavPathStack = new NavPathStack();

  // Â∏ÇÂú∫
  // @State selectedTab: number = 1 // ËèúÂ∏ÇÂú∫tabÈÄâ‰∏≠


  build() {
    Column() {
      // È°∂ÈÉ®ÂÆâÂÖ®Âå∫Âüü
      // Blank()
      //   .height(44)

      // È°∂ÈÉ®ÂØºËà™Ê†è
      Row() {
        Text('ËèúÂ∏ÇÂú∫ÂØºË¥≠')
          .fontSize(20)
          .fontWeight(FontWeight.Bold)
          .fontColor('#333')

        Blank()

        Row() {
          Image($r('app.media.ic_market_search'))
            .width(24)
            .height(24)
            .fillColor('#666')
          Image($r('sys.media.ohos_ic_public_more'))
            .width(24)
            .height(24)
            .fillColor('#666')
            .margin({ left: 12 })
        }
      }
      .width('100%')
      .height(50)
      .padding({ left: 16, right: 16 })
      .backgroundColor('#FFFFFF')

      // ÂàÜÈöîÁ∫ø
      Divider()
        .color('#E0E0E0')
        .strokeWidth(1)

      // ÂàÜÁ±ªÁ≠õÈÄâÂå∫
      Scroll() {
        Row() {
          ForEach(['ÂÖ®ÈÉ®', 'Ëî¨Ëèú', 'Ê∞¥Êûú', 'ËÇâÁ±ª', 'Êµ∑È≤ú', 'Ë∞ÉÊñô', 'Á≤ÆÊ≤π', 'Ë±ÜÂà∂ÂìÅ'], (category: string) => {
            Text(category)
              .fontSize(14)
              .fontColor(this.selectedCategory === category ? '#FFFFFF' : '#333')
              .backgroundColor(this.selectedCategory === category ? '#4CAF50' : '#F5F5F5')
              .borderRadius(16)
              .padding({
                left: 16,
                right: 16,
                top: 8,
                bottom: 8
              })
              .margin({ right: 10 })
              .onClick(() => {
                this.selectedCategory = category
              })
          })
        }
        .padding({
          left: 16,
          right: 16,
          top: 12,
          bottom: 6
        })
      }
      .scrollable(ScrollDirection.Horizontal)
      .scrollBar(BarState.Off)

      // ÂïÜÊà∑Êé®ËçêÂå∫
      Column() {
        Text('üè™ Êé®ËçêÂïÜÊà∑')
          .fontSize(18)
          .fontWeight(FontWeight.Bold)
          .fontColor('#333')
          .alignSelf(ItemAlign.Start)
          .margin({ left: 16, top: 16, bottom: 12 })

        List() {
          ForEach(this.merchants, (item: merchant) => {
            ListItem() {
              Row() {
                Image(item.image)
                  .width(100)
                  .height(80)
                  .borderRadius(8)

                Column() {
                  Text(item.merchantName)
                    .fontSize(16)
                    .fontWeight(FontWeight.Bold)
                    .fontColor('#333')
                    .alignSelf(ItemAlign.Start)

                  Text(item.introduction)
                    .fontSize(12)
                    .fontColor('#666')
                    .margin({ top: 4 })
                    .alignSelf(ItemAlign.Start)

                  Text('Â•ΩËØÑÁéá' + item.positiveFeedbackRate + '%')
                    .fontSize(12)
                    .fontColor('#4CAF50')
                    .margin({ top: 8 })
                    .alignSelf(ItemAlign.Start)
                }
                .alignItems(HorizontalAlign.Start)
                .margin({ left: 12 })
                .layoutWeight(1)
              }
              .width('100%')
              .height(100)
              .backgroundColor('#FFFFFF')
              .borderRadius(8)
              .padding(12)
              .margin({ left: 16, right: 16, bottom: 10 })
              .shadow({
                radius: 4,
                color: '#E0E0E0',
                offsetX: 0,
                offsetY: 2
              })
            }
          }
          )
        }
        .height(350)

      }

      Blank()

      // ÁÉ≠Èó®ÂïÜÂìÅÊé®ËçêÂå∫
      Column() {
        Row() {
          Text('üî• ÁÉ≠Èó®ÂïÜÂìÅ')
            .fontSize(20)
            .fontWeight(FontWeight.Bold)
            .fontColor('#333')
          Blank()
          Text('Êü•ÁúãÊõ¥Â§ö >')
            .fontSize(14)
            .fontColor('#888')
        }
        .width('100%')
        .padding({ left: 16, right: 16, top: 16 })

        // ÂïÜÂìÅÁΩëÊ†ºÔºàÂåÖË£π‰∏∫ÂèØÊªöÂä®ÂàóË°®Ôºå‰øùÁïôÂéüÂç°ÁâáÊ†∑ÂºèÔºâ
        Scroll() {
          Flex({ wrap: FlexWrap.Wrap, justifyContent: FlexAlign.SpaceBetween }) {
            ForEach(this.products, (item: product) => {

              // ÂïÜÂìÅ1
              Column() {
                Image(item.image)
                  .width('100%')
                  .aspectRatio(1)
                  .borderRadius(8)

                Text(item.productName)
                  .fontSize(14)
                  .fontColor('#333')
                  .margin({ top: 8 })
                  .alignSelf(ItemAlign.Start)

                Text('¬•' + item.price + '/' + item.unit)
                  .fontSize(14)
                  .fontWeight(FontWeight.Bold)
                  .fontColor('#E53935')
                  .margin({ top: 4 })
                  .alignSelf(ItemAlign.Start)

                Button('Ë¥≠‰π∞')
                  .fontSize(12)
                  .fontColor('#FFFFFF')
                  .backgroundColor('#4CAF50')
                  .borderRadius(6)
                  .width('100%')
                  .height(32)
                  .margin({ top: 8 })
              }
              .width('45%')
              .backgroundColor('#FFFFFF')
              .borderRadius(8)
              .padding(12)
              .margin({ bottom: 16 })
              .shadow({
                radius: 4,
                color: '#E0E0E0',
                offsetX: 0,
                offsetY: 2
              })
            }

            )
          }
          .width('100%')
          .padding({ left: 16, right: 16 })
        }
        .padding({ bottom: this.TABBAR_HEIGHT })
        .height(420)
        .scrollable(ScrollDirection.Vertical)
        .scrollBar(BarState.Off)
      }
      
      // ÊÇ¨ÊµÆË¥≠Áâ©ËΩ¶ÊåâÈíÆ
      FloatingCartButton({ pageStack: this.pageStack })
    }
    .width('100%')
    .height('100%')
    .backgroundColor('#FFFFFF')
  }
}